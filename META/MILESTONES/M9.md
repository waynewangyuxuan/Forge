# M9: 集成与打磨

> **目标**：完成 MVP，准备发布

**状态**: pending
**依赖**: M8

---

## 交付物

### 功能完善

- [ ] 端到端测试（完整流程）
- [ ] 错误处理完善（边界情况）
- [ ] System Use Cases
  - [ ] get-settings.ts
  - [ ] update-settings.ts
  - [ ] select-folder.ts
  - [ ] check-claude.ts
  - [ ] get-app-info.ts
- [ ] system.ipc.ts
- [ ] shell.ipc.ts（打开编辑器、目录）
- [ ] Claude CLI 状态检测与提示

### UI 打磨

- [ ] 空状态 UI
  - [ ] 无项目
  - [ ] 无版本
  - [ ] 无运行记录
- [ ] 加载状态 UI
- [ ] 错误状态 UI
- [ ] SettingsPage 完整实现

### 发布准备

- [ ] 应用图标设计
- [ ] electron-builder 打包配置
- [ ] macOS .dmg 打包
- [ ] Windows .exe 打包（可选）
- [ ] 基础 README

---

## 验收标准

- [ ] 能从头完成完整流程：
  1. 创建项目
  2. 编写 Spec
  3. 生成 Scaffold
  4. Review & Approve
  5. 执行代码生成
  6. 配置运行
  7. 触发运行
  8. 查看 Dashboard
- [ ] 无明显 Bug
- [ ] 错误有友好提示
- [ ] 应用能打包为 .dmg

---

## IPC 通道

| 通道 | 说明 |
|------|------|
| `system:getSettings` | 获取全局设置 |
| `system:updateSettings` | 更新设置 |
| `system:selectFolder` | 目录选择对话框 |
| `system:checkClaude` | 检查 Claude CLI |
| `system:getAppInfo` | 获取应用信息 |
| `shell:openInEditor` | 用 VSCode 打开 |
| `shell:openFolder` | 用 Finder 打开 |
| `shell:openExternal` | 打开外部链接 |

---

## 端到端测试场景

```
1. 首次启动
   - [ ] 检测 Claude CLI
   - [ ] 显示欢迎/引导（可选）

2. 项目创建流程
   - [ ] 点击 New Project
   - [ ] 填写名称，选择目录
   - [ ] 项目创建成功，跳转到 Spec 页

3. Spec → Scaffold
   - [ ] 编写 PRODUCT.md
   - [ ] 编写 TECHNICAL.md
   - [ ] 点击 Generate
   - [ ] 看到进度，生成成功
   - [ ] 跳转到 Review 页

4. Review → Execute
   - [ ] 查看任务列表
   - [ ] 点击 Approve
   - [ ] 跳转到 Execute 页
   - [ ] 点击 Start
   - [ ] 看到任务逐个执行
   - [ ] 全部完成

5. Runtime
   - [ ] 配置 Manual 模式
   - [ ] 配置 Credentials
   - [ ] 触发运行
   - [ ] 查看日志

6. Dashboard
   - [ ] 配置 DASHBOARD.yaml
   - [ ] 查看指标
```

---

## Settings 页面

```
┌─────────────────────────────────────────────────────┐
│ Settings                                             │
├─────────────────────────────────────────────────────┤
│                                                     │
│ General                                             │
│ ─────────────────────────────────────────────       │
│ Default Project Path: [~/Projects        ] [...]   │
│                                                     │
│ Claude CLI                                          │
│ ─────────────────────────────────────────────       │
│ Status: ● Available (v1.2.3)                        │
│                                                     │
│ Global Credentials                                  │
│ ─────────────────────────────────────────────       │
│ ┌──────────────┬────────────────┬─────────┐        │
│ │ Nickname     │ Type           │ Actions │        │
│ ├──────────────┼────────────────┼─────────┤        │
│ │ my-notion    │ NOTION_API     │ [Edit]  │        │
│ │ github-token │ GITHUB_TOKEN   │ [Edit]  │        │
│ └──────────────┴────────────────┴─────────┘        │
│                              [+ Add Credential]     │
│                                                     │
│ About                                               │
│ ─────────────────────────────────────────────       │
│ Forge v0.1.0                                        │
│ Data: ~/Library/Application Support/Forge          │
│                                                     │
└─────────────────────────────────────────────────────┘
```

---

## 参考文档

- [IPC.md](../IPC/IPC.md) - 2.9 Shell, 2.10 System
- [PRODUCT.md](../CORE/PRODUCT.md) - 成功标准
